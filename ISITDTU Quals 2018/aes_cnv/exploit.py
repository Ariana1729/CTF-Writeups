from hashlib import md5
from base64 import b64decode
from base64 import b64encode
from pwn import *
i=0
while True:
    i+=1
    p=remote('35.185.111.53','13337')
    p.recvuntil("encrypt: ")
    p.send("0123456789abcdef"*(i+1)+"Give me the flag")
    p.recvuntil("encypted: ")
    ciptext=p.recvline()
    ciptext=b64decode(ciptext)
    iv=md5(ciptext[-64:-48]).digest()
    solblk=ciptext[-48:]
    p.recvuntil("request: ")
    p.sendline(b64encode(iv+solblk))
    print "\nTrying len(self.secret)="+str(i)+"\n"
    flag=p.recvall()
    if("This is flag:" in flag):
        print flag
        break
    p.close()

