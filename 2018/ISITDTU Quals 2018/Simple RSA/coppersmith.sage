err=17
p1p4=24556891073418994576751524607635760117996811894972202516187698043229292302109114380884247668494990605537878648233446996676371523211326680052450374168750431
p1_approx=isqrt(p1p4/1000)
p4_approx=1000*p1_approx+2**err
F.<x>=PolynomialRing(Zmod(p1p4),implementation='NTL')
f=x-p4_approx
d=f.small_roots(X=2**err,beta=0.5)
d=d[0]
p4=p4_approx-d
p1=int(p1p4)/int(p4)
p2p3=24556891073418994576751524607635760117996811894972202516187698043229292302185592473522031534536176858756163591603824821794497153855658790721132779232081801
p2_approx=isqrt(p2p3/10)
p3_approx=10*p2_approx+2**err
F.<x>=PolynomialRing(Zmod(p2p3),implementation='NTL')
f=x-p3_approx
d=f.small_roots(X=2**err,beta=0.5)
d=d[0]
p3=p3_approx-d
p2=int(p2p3)/int(p3)
print('p1',p1)
print('p2',p2)
print('p3',p3)
print('p4',p4)
