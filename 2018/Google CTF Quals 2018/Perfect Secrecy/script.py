from pwn import *
from Crypto.Util.number import long_to_bytes, bytes_to_long
import math
def bintoint(bitlist):
	out = 0
	for bit in bitlist:
		out = (out << 1) | bit
	return out
def pad(i):
	return ("\x00"*128+i)[len(i):]
c=bytes_to_long('\xa9\xc5e\xcb\xc2\xcf\x1c}Bg\xfd\x17i\xdc\xe9\xf04\x81\x80\x0b\xba\xe8k\xb0\x92j\xe6\x17\xa7\xe6\xd0\x9f,a\xa9\xd7\n\x85g\x83\x97<LU\xbfC\xa2L\x1dp\xf7\xb0*\xc04\xff9\xc57\xab9\xc7\x8d\x90R:\x81\x07\xa0\x98\x01\x95\xdf5!\xd6T\xd7 i\xf9B\x82\x08C\x1c\xc7c\xde\xf3\x9b\xcd\x8c\xd3\xea\x9dE\xe9\x9e#\xf7\x81\x0f\xa0;l\xe9\x06\xd6\xf4\x13s\xe0\xe2\xa7\xc0"0\x18(\xd7\xf8\x0e\xd3\xc60\xaeV')
n=153314286737753283255547252902231988923677001570537670823569737192417931917849858323550190365704182153062786056662711312188848241990605760007378096173801480759292810572306932509446953082431394351272757346605609898944553806892979792999103404028562806843687533668219905113924888506316958727392199113512716600273
e=65537
arr=[0]*1024
for i in range(1024):
	p=remote("perfect-secrecy.ctfcompetition.com",1337)
	p.send("BA"+pad(long_to_bytes((c*pow(2,(i+1)*e,n))%n)))
	parity=p.recvall()
	if(parity.count("\x00")<parity.count("\x01")):
		print(str(i)+" 1")
		arr[i]=1
	else:
		print(str(i)+" 0")
		arr[i]=0
	p.close()
	if(bintoint(arr)!=0):
		print long_to_bytes(n*bintoint(arr)/pow(2,1024))
'''
arr=0000000000000010110010101110100011110110001110101001011010010100011110000111011100100111111010000110100111100101000001001111000010111010101111001110100010111100111000110010001010000100111100111110110000010111110001101001110101100111100100011011011000110101111110000101010100110110001100100000100101000001000000010111101110001000100100000101110100111110110101000011100111110110101000111011001011101010100111111100010111010000101111110001011111111011110001110011110000001010000111100001100100010001000010001010000011000100001111100100100110100001101101010111101011110011010110110101101000110101101000010010111101010010110110111111010110110111100110000000000100100100011000000011100100001010101010110111000011011101010011000110001001110111110101010100100111101011001011110011100011001000000110001111101100010110101001011110000000101101100011010100101001111110101100111101000110001110111010110001001010011011000110100001110101010101001000100110001011010011010100111001011010001000100000111011100010001111000100100100011111001110
i think
'''
